100 REM Unit Tests for POKE SCREEN, PEEK SCREEN, and COPY SCREEn
110 QG$="rg"
120 GOSUB _init

200 GOSUB _title:ARGS "POKE SCREEN, POKE COLOR. PEEKSCREEN(), PEEKCOLOR(), PEEKSCREEN$(), PEEKCOLOR$()"

210 FOR S=2 TO 3
212 SCREEN S:IF S=2 THEN CLS
214 WF=-(S=3):SW=40+40*WF:MX=1023+1024*WF:LA=999+1000*WF
216 GOSUB _title:ARGS "%% Column Screen" % (SW)

300 GOSUB _output:ARGS LIST$(NEXT)
302 POKE SCREEN 1,64:POKE COLOR 1,$70
304 GOSUB _assert:ARGS "PEEKSCREEN(1)=64"
306 GOSUB _assert:ARGS "PEEKCOLOR(1)=$70"

310 GOSUB _output:ARGS LIST$(NEXT)
312 POKE SCREEN 2,"Test":POKE COLOR 2,$"07060706"
314 GOSUB _assert:ARGS "PEEKSCREEN$(2,4)=`Test`"
316 GOSUB _assert:ARGS "PEEKCOLOR$(2,4)=$`07060706`"

320 GOSUB _output:ARGS "LA=%%" %(LA)
322 GOSUB _output:ARGS LIST$(NEXT)
324 POKE SCREEN LA,'#':POKE COLOR LA,$0A
326 GOSUB _assert:ARGS "PEEKSCREEN(LA)='#'"
328 GOSUB _assert:ARGS "PEEKCOLOR(LA)=$0A"

332 GOSUB _output:ARGS LIST$(NEXT)
334 POKE SCREEN LA+1,"tseT":POKE COLOR LA+1,$"06070607"
336 GOSUB _assert:ARGS "PEEKSCREEN$(LA+1,4)=`tseT`"
338 GOSUB _assert:ARGS "PEEKCOLOR$(LA+1,4)=$`06070607`"

340 GOSUB _output:ARGS "MX=%%" %(MX)
342 GOSUB _output:ARGS LIST$(NEXT)
344 POKE SCREEN MX,$0A:POKE COLOR MX,$A0
346 GOSUB _assert:ARGS "PEEKSCREEN(MX)=$0A"
348 GOSUB _assert:ARGS "PEEKCOLOR(MX)=$A0"

400 QE=5
402 GOSUB _pokes_err:ARGS 1,-257,5
404 GOSUB _pokes_err:ARGS 1,256,5
406 GOSUB _pokes_err:ARGS -1,64,5
408 GOSUB _pokes_err:ARGS MX+1,64,5

412 GOSUB _pokec_err:ARGS 1,-1,5
414 GOSUB _pokec_err:ARGS 1,256,5
416 GOSUB _pokec_err:ARGS -1,64,5
418 GOSUB _pokec_err:ARGS MX+1,64,5

422 GOSUB _pokess_err:ARGS -1,"doh",5
424 GOSUB _pokess_err:ARGS MX-1,"doh",5
426 GOSUB _pokecs_err:ARGS -1,"doh",5
428 GOSUB _pokecs_err:ARGS MX-1,"doh",5

442 GOSUB _assert_err:ARGS "PEEKSCREEN(-1)",5
444 GOSUB _assert_err:ARGS "PEEKSCREEN(MX+1)",5
446 GOSUB _assert_err:ARGS "PEEKCOLOR(-1)",5
448 GOSUB _assert_err:ARGS "PEEKCOLOR(MX+1)",5

452 GOSUB _assert_err:ARGS "PEEKSCREEN$(-1,3)",5
454 GOSUB _assert_err:ARGS "PEEKSCREEN$(MX-1,3)",5
456 GOSUB _assert_err:ARGS "PEEKCOLOR$(-1,3)",5
458 GOSUB _assert_err:ARGS "PEEKCOLOR$(MX-1,3)",5

500 NEXT S:GOTO _finish

600 _pokes_err: GETARGS PA,PB,QE:QA$="POKE SCREEN %%,%%" % (PA,PB):ON ERROR GOTO _yes_err:POKE SCREEN PA,PB:GOTO _no_err
610 _pokec_err: GETARGS PA,PB,QE:QA$="POKE COLOR %%,%%" % (PA,PB):ON ERROR GOTO _yes_err:COLOR SCREEN PA,PB:GOTO _no_err
620 _pokess_err: GETARGS PA,PS$,QE:QA$="POKE SCREEN %%,`%%`" % (PA,PS$):ON ERROR GOTO _yes_err:POKE SCREEN PA,PS$:GOTO _no_err
630 _pokecs_err: GETARGS PA,PS$,QE:QA$="POKE COLOR %%,`%%`" % (PA,PS$):ON ERROR GOTO _yes_err:POKE COLOR PA,PS$:GOTO _no_err

