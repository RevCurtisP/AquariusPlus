100 REM Unit Tests for COPY SCREEN
110 QG$="dr"
120 GOSUB _init

200 GOSUB _title:ARGS "COPY SCREEN"
205 SCREEN 2:CLS:SCREEN 3

210 GOSUB _output:ARGS "Building Screens"
212 NC$="TestText":NA$=$"0110011001100110":WC$=NC$+NC$:WA$=NA$+NA$
214 NC=0:NA=1024:WC=2048:WA=4096:FOR I=1 TO 128
216 POKE @32,NC,NC$;@32,NA,NA$;@32,WC,WC$;@32,WA,WA$
218 NC=NC+8:NA=NA+8:WC=WC+16:WA=WA+16:NEXT:FILL BYTES @33,0,16384,$5A

220 GOSUB _title:ARGS "40-Column Screen"
221 GOSUB _output:ARGS LIST$(NEXT):SCREEN 2
222 COPY @32,0 TO SCREEN:COPY SCREEN TO @33,0
224 GOSUB _getkey:SCREEN 3
226 GOSUB _assert:ARGS "COMPARE(@33,0,@32,0,2048)"
228 GOSUB _assert:ARGS "PEEK(@33,2048)=$5A"
229 GOSUB   _pause


240 GOSUB _title:ARGS "40-Column Character Matrix"
241 GOSUB _output:ARGS LIST$(NEXT):SCREEN 2
242 CLS:COPY @32,0 TO SCREEN CHR:C=PEEKCOLOR(0)
244 SCREEN 3
246 GOSUB _assert:ARGS "C=6"
248 GOSUB _output:ARGS LIST$(NEXT):SCREEN 2
250 COPY SCREEN CHR TO @33,2048
253 GOSUB _getkey:SCREEN 3
254 GOSUB _assert:ARGS "COMPARE(@33,2048,@32,0,1024)"
256 GOSUB _assert:ARGS "PEEK(@33,3072)=$5A"
259 GOSUB   _pause

260 GOSUB _title:ARGS "40-Column Color Matrix"
261 GOSUB _output:ARGS LIST$(NEXT):SCREEN 2
262 COPY @32,1024 TO SCREEN ATTR:COPY SCREEN ATTR TO @33,3072
264 GOSUB _getkey:SCREEN 3
266 GOSUB _assert:ARGS "COMPARE(@33,3072,@32,1024,1024)"
268 GOSUB _assert:ARGS "PEEK(@33,4096)=$5A"
269 GOSUB   _pause

320 GOSUB _title:ARGS "80-Column Screen"
321 GOSUB _output:ARGS LIST$(NEXT):STASH SCREEN
322 COPY @32,2048 TO SCREEN:COPY SCREEN TO @33,4096
324 GOSUB _getkey:RESTORE SCREEN
326 GOSUB _assert:ARGS "COMPARE(@33,4096,@32,2048,4096)"
328 GOSUB _assert:ARGS "PEEK(@33,8192)=$5A"
329 GOSUB   _pause

340 GOSUB _title:ARGS "80-Column Character Matrix"
341 GOSUB _output:ARGS LIST$(NEXT):STASH SCREEN
342 CLS:COPY @32,2048 TO SCREEN CHR:C=PEEKCOLOR(0)
344 SWAP SCREEN
346 GOSUB _assert:ARGS "C=6"
348 GOSUB _output:ARGS LIST$(NEXT):SWAP SCREEN
350 COPY SCREEN CHR TO @33,8192
353 GOSUB _getkey:SWAP SCREEN
354 GOSUB _assert:ARGS "COMPARE(@33,8192,@32,2048,2048)"
356 GOSUB _assert:ARGS "PEEK(@33,10240)=$5A"
359 GOSUB   _pause

360 GOSUB _title:ARGS "80-Column Color Matrix"
361 GOSUB _output:ARGS LIST$(NEXT):SWAP SCREEN
362 COPY @32,4096 TO SCREEN ATTR:COPY SCREEN ATTR TO @33,10240
364 GOSUB _getkey:SWAP SCREEN
366 GOSUB _assert:ARGS "COMPARE(@33,10240,@32,4096,2048)"
368 GOSUB _assert:ARGS "PEEK(@33,12288)=$5A" 
369 GOSUB   _pause
