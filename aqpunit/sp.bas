100 REM Test Save and Load Palette

110 QG$="ss"
120 GOSUB _init

200 GOSUB _title:ARGS "SAVE PALETTE and LOAD PALETTE"
202 SET FILE ERROR OFF
204 WD$="work":MKDIR wd$
208 SET FILE ERROR ON
220 DIM L$(16):' Palette load array

230 DEF FND(Z)=Z*16+Z

300 GOSUB _title:ARGS "LOAD PALETTE"

320 GOSUB _output:ARGS LIST$(NEXT): 'Native Palette (32 bytes)
322 LOAD PALETTE 0,"assets/gray.pal":G$=HEX$(GETPALETTE$(0))
324 GOSUB _assert:ARGS "G$=`0000110122023303440455056606770788089909AA0ABB0BCC0CDD0DEE0EFF0F`"
326 RESET PALETTE 0 

360 GOSUB _output:ARGS LIST$(NEXT): 'ASCII Palette (64 byte)
362 LOAD PALETTE 2,"assets/c64.asc":G$=HEX$(GETPALETTE$(2))
364 GOSUB _assert:ARGS "G$=`0000FF0F0008FE0A4C0CC5000A00E70E850D4006770F33037707F60A8F00BB0B`"

500 GOSUB _title:ARGS "SAVE PALETTE"

520 GOSUB _output:ARGS LIST$(NEXT): 'Native palette (gray)
521 P$=$"0000110122023303440455056606770788089909AA0ABB0BCC0CDD0DEE0EFF0F"
522 GOSUB _output:ARGS LIST$(NEXT):
523 SET PALETTE 0 TO P$:SAVE PALETTE 0,"work/0.pal":LOAD "work/0.pal",^L$
526 GOSUB _assert:ARGS "L$=P$"
528 RESET PALETTE 0:DEL "work/0.pal"

599 goto _finish

600 GOSUB _title:ARGS "LOAD/SAVE PALETTE errors"

620 GOSUB _output:ARGS LIST$(NEXT)
622 SET FILE ERROR OFF:LOAD PALETTE 1,"nopalette.palt":SET FILE ERROR ON
624 GOSUB _assert:ARGS "ERR=50"
