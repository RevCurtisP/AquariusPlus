100 REM Test
105 SET FNKEY 3 TO \"run /subr/filepicker.bas\r"
110 DIM ZD$(20):D$="/demos/charmaps/charmaps/*.chr"
115 CLS:GOSUB _fpick:ARGS 2,2,20,20,0,7,7,0,D$ RETURN F$
120 LOCATE 1,21:PRINT F$

8999 END

9100 _fpick:REM File picker
9105 REM LeftCol,TopRow,RightCol,BottomRow,SelFG,SelBG,UnselFG,UnselBG,Filespec
9110 GETARGS ZL,ZT,ZR,ZB,ZF,ZG,ZU,ZV,ZF$:ZH=ZB-ZL+1:ZW=ZR-ZL+1
9115 FILL SCREEN (ZL,ZT)-(ZR,ZB) CHR ' ' COLOR ZU,ZV
9120 ZN=ZB-ZT+1:ZS=1:LOAD DIR ZF$,*ZD$:ZD=VAL(ZD$(0))
9130 FOR I=1 TO ZN:LOCATE ZL,ZT+I-2:PRINT MID$(ZD$(I),10,ZW);:IF I<ZD THEN NEXT
9135 POKE DEEK($3801),PEEK($380D):REM Hide Cursor
9140 ZY=ZT+ZS-1:FILL SCREEN (ZL,ZY)-(ZR,ZY) COLOR ZF,ZG
9145 ZK=GETKEY:FILL SCREEN (ZL,ZY)-(ZR,ZY) COLOR ZU,ZV
9150 IF ZK=13 THEN RETURN MID$(ZD$(ZS),10)
9160 ZS=ZS-(ZK=159 AND ZS<ZD)+(ZK=143 AND ZS>1)
9190 GOTO 9140
