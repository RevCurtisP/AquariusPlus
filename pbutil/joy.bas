100 REM Gamepad Test
105 SET FNKEY 7 TO "run "+ARGS$(0)+CHR$(13)

120 DIM K(6)=,$40,$84,$A0,$20,$82,$81
125 DIM P(16)=,$2,$12,$13,$3,$1,$11,$19,$9,$8,$18,$1C,$C,$4,$14,$16,$6
130 S(0)=' ':S(1)='*':S(2)=$C6

200 CLS
210 PRINT
220 PRINT: 'TAB(2);"00000000";TAB(16);"00000000"
225 PRINT
230 FOR I=1 TO 16
232 IF I<7 THEN PRINT TAB(2);"K%%" % (I);
233 PRINT TAB(7+(I>9));"P%%" % (I);
234 IF I<7 THEN PRINT TAB(16);"K%%" % (I);
235 PRINT TAB(21+(I>9));"P%%" % (I);
236 PRINT
238 NEXT
240 CLEAR CURSOR

300 _main:
310 J=JOY(1):K=SGN(J AND $E0):C=K AND J:P=J AND $1F
315 POKE SCREEN 45,HEX$(J)
321 K1=(J AND $40)=$40:POKE SCREEN 166,S(-K1)
322 K2=(J AND $84)=$84:POKE SCREEN 206,S(-K2)
323 K3=(J AND $A0)=$A0:POKE SCREEN 246,S(-K3)
324 K4=(J AND $20)=$20:POKE SCREEN 286,S(-K4-K3)
325 K5=(J AND $82)=$82:POKE SCREEN 326,S(-K5)
326 K6=(J AND $81)=$81:POKE SCREEN 366,S(-K6)

331 C1=(C AND $01)=$01  
332 C2=(C AND $02)=$02  
333 C3=(C AND $03)=$03  
334 C6=(C AND $06)=$06  
335 C5=(C AND $05)=$05  
336 C6=(C AND $06)=$06  
337 C6=(C AND $07)=$07  

341 P1=(P AND $02)=$02:POKE SCREEN 171,S(-P1-C2)
342 P2=(P AND $12)=$12:POKE SCREEN 211,S(-P2)
343 P3=(P AND $13)=$13:POKE SCREEN 251,S(-P3)
344 P4=(P AND $03)=$03:POKE SCREEN 291,S(-P4-C3)
345 P5=(P AND $01)=$01:POKE SCREEN 331,S(-P5-C1)
346 P6=(P AND $11)=$11:POKE SCREEN 371,S(-P6)
347 P7=(P AND $19)=$19:POKE SCREEN 411,S(-P7)
348 P8=(P AND $09)=$09:POKE SCREEN 451,S(-P8)
349 P9=(P AND $08)=$08:POKE SCREEN 491,S(-P9)
350 PA=(P AND $18)=$18:POKE SCREEN 531,S(-PA)
351 PB=(P AND $1C)=$1C:POKE SCREEN 571,S(-PB)
352 PC=(P AND $0C)=$0C:POKE SCREEN 611,S(-PC)
353 PD=(P AND $04)=$04:POKE SCREEN 651,S(-PD-C4)
354 PE=(P AND $14)=$14:POKE SCREEN 691,S(-PE)
355 PF=(P AND $16)=$16:POKE SCREEN 731,S(-PF)
356 PG=(P AND $06)=$06:POKE SCREEN 771,S(-PG-C6)

490 GOTO _main


915 A=106+C*14
930 FOR R=1 TO 16
935 A=A+40
940 IF R<7 THEN POKE SCREEN A+6,S(-(K=(K(R))))
950 POKE SCREEN A+11,S(-(P=P(R)))
